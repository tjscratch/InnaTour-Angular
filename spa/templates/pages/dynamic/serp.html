<ng:include src="'/spa/templates/pages/dynamic/inc/bundle.html'" ng-if="combination.Hotel && combination.AviaInfo"></ng:include>

<div class="results-body" ng-show="!showLanding">
    <ng:include src="state.display"></ng:include>
</div>

<div ng-controller="DynamicPackageSERPTicketPopupCtrl">
    <div style="display:block;" class="overlay js-overlay" ng-if="ticket.data">
        <div class="balloon baloon_ticket baloon_2ticket">
            <div title="Закрыть" class="baloon-close" ng-click="closePopup()"></div>
            <h3 class="b-tickets__title">Подробная и информация по перелту</h3>

            <div class="rlf-oneway">

                <div class="b-ticket_2ways">
                    <div class="rlf-fly">
                        <span class="rlf-city">{{ticket.data.CityFrom}}</span> {{ticket.data.OutCode}}
                        <span class="rlf-fly-arrow"></span>
                        <span class="rlf-city">{{ticket.data.CityTo}}</span> {{ticket.data.InCode}}
                        <div class="rlf-full-travel-time">{{ticket.data.EtapsTo.length - 1 | asQuantity:"пересадка":"пересадки":"пересадок"}}, {{ticket.getDuration('To')}} в пути</div>
                    </div>
                    <div class="rlf-fly">
                        <span class="rlf-city">{{ticket.data.CityTo}}</span> {{ticket.data.InCode}}
                        <span class="rlf-fly-arrow"></span>
                        <span class="rlf-city">{{ticket.data.CityFrom}}</span> {{ticket.data.OutCode}}
                        <div class="rlf-full-travel-time">{{ticket.data.EtapsBack.length - 1 | asQuantity:"пересадка":"пересадки":"пересадок"}}, {{ticket.getDuration('Back')}} в пути</div>
                    </div>
                </div>

                <div class="b-ticket_2ways b-ticket_2ways-sep">

                    <div class="b-ticket_2ways-block" ng-repeat="dir in ['To', 'Back']">
                        <div ng-repeat="etap in ticket.getEtaps(dir)">
                            <div class="rlf-part">
                                <div class="rfl-column3">
                                    <div class="rlf-aviacompany">
                                        <img ng-src="{{airLogo(etap.data.TransporterCode)}}" alt="">
                                        {{etap.data.TransporterName}} <br>
                                        рейс {{etap.data.Number}} <br>
                                        {{etap.data.VehicleName}}
                                    </div>
                                </div>
                                <div class="b-tickets__container">
                                    <div class="b-tickets__block">
                                        <div class="rlf-column1">
                                            <div class="rlf-airport">{{etap.data.OutCityCode}}</div>
                                        </div>
                                        <div class="rlf-colum2">
                                            <div class="rlf-flight-info">
                                                <b>вылет {{dateHelper.getTime(etap.getDateTime('Out'))}}</b>, {{dateHelper.getDateShort(etap.getDateTime('Out'))}}, {{dateHelper.getDay(etap.getDateTime('Out'))}} <br>
                                                {{etap.data.OutCity}}, {{etap.data.OutPort}}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="rlf-travel-time">{{etap.getDuration()}}</div>
                                    <div class="b-tickets__block">
                                        <div class="rlf-column1">
                                            <div class="rlf-airport"><br>{{etap.data.InCityCode}}</div>
                                        </div>
                                        <div class="rlf-colum2">
                                            <div class="rlf-flight-info">
                                                <b>прилет {{dateHelper.getTime(etap.getDateTime('In'))}}</b>, {{dateHelper.getDateShort(etap.getDateTime('In'))}}, {{dateHelper.getDay(etap.getDateTime('In'))}} <br>
                                                {{etap.data.InCity}}, {{etap.data.InPort}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="rlf-part rlf-part_transfer" ng-if="!$last">
                                <div class="rlf-column1">
                                    <div class="rlf-airport">Пересадка</div>
                                    <div class="rlf-travel-time">{{etap.getLegDuration()}}</div>
                                </div>
                                <div class="rlf-colum4">
                                    {{etap.data.InCity}}, {{etap.data.InPort}} ({{etap.data.InCityCode}}), {{etap.data.InCountryName}}
                                    <div class="rlf-transfer" ng-repeat="next in [ticket.getNextEtap(dir, etap)]">
                                        <span ng-if="next.data.OutPort != etap.data.InPort">Внимание: смена аэропорта!</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="b-tickets__footer">
                <ul class="b-tickets__icons">
                    <li><a href="#" class="b-tickets__icons-link"></a></li>
                    <li><a href="#" class="b-tickets__icons-print"></a></li>
                    <li><a href="#" class="b-tickets__icons-share"></a></li>
                </ul>
                <div class="b-tickets__footer-inner">
                    <a class="rl-buy-button" href="javascrip:void(0);" ng-click="setCurrent()">Выбрать</a>
                </div>
            </div>

        </div>
    </div>
</div>

<div ng-if="hotelToShowDetails"
     inna-hotel-details
     inna-hotel-details-hotel="hotelToShowDetails"
     inna-hotel-details-collection="hotels"
     inna-hotel-details-back="closeHotelDetails"
     inna-hotel-details-next="replaceHotelToShowDetails"></div>