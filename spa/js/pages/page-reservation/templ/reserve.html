<!-- Buy ticket -->
<form action="javascript:void(0)" method="post" class="results-body reserve-form">
<div class="main__center">
<ng:include src="objectToReserveTemplate"></ng:include>

<div class="buy__warning" ng-if="visaControl.visaNeeded || visaControl.visaRulesNeeded">
    <div ng-if="visaControl.visaNeeded">Требуется виза.</div>
    <div ng-if="visaControl.visaRulesNeeded">Обратите внимание на визовые правила
                <span ng-if="visaControl.cautionCountries.length > 0"> в странах: <span
                        ng-repeat="c in visaControl.cautionCountries">{{c}}<span ng-if="!($last)">,&nbsp;</span></span></span>.
    </div>
</div>

<p class="buy__price-descr buy__alert" ng-if="(hotel != null)">Внимание! К компонентам пакета применяются разные условия отмены
    бронирования.<br/>Пожалуйста, ознакомьтесь с <a href="" ng-click="tarifs.show($event)">правилами применения тарифа
        авиабилета</a> и <a href="" ng-click="hotelRules.show($event)">условиями бронирования отеля</a>.</p><br/>

<p class="buy__price-descr" ng-if="!(hotel != null)">Пожалуйста, ознакомьтесь с <a href=""
                                                                                   ng-click="tarifs.show($event)">правилами
    применения тарифа авиабилета</a>.</p><br/>

<header class="buy__header">
    <h2 class="buy__title">Информация о покупателе</h2>
</header>

<div>
    <div class="b-field-group">
        <!--<div class="b-field-block b-field-block-auth" style="width: 388px;">-->
        <div class="b-field-block" style="width: 388px;">
            <label class="b-field-label">E-mail</label>
            <input autocomplete="off" validate-events-dir ng-model="validationModel.email.value"
                   ng-validation-model="validationModel.email" validate="validate(item, type)"
                   validate-type="validateType.email"
                   ng-class="{error:isFieldInvalid(validationModel.email)}"
                   data-title="Неправильно введен email" type="text"
                   placeholder="ivan.ivanov@gmail.com" class="b-field-text">
            <!--<div class="b-auth">
               <a href="#" class="b-auth-close"></a>
               <p class="b-auth-text">Мы определили, что вы уже зарегистрированы</p>
               <a href="#" class="button b-auth-button">Войти</a>
           </div>-->
        </div>
        <div class="b-field-block" style="width: 180px;">
            <label class="b-field-label">Мобильный телефон</label>
            <input autocomplete="off" validate-events-dir ng-model="validationModel.phone.value"
                   ng-validation-model="validationModel.phone" validate="validate(item, type)"
                   validate-type="validateType.phone"
                   supress-select-on-value="'+7'"
                   ng-class="{error:isFieldInvalid(validationModel.phone)}"
                   data-title="Неправильно введен мобильный телефон" name="phone" type="text"
                   phone-input class="b-field-text">
        </div>
    </div>
    <!-- <div class="error-text">Поля отмеченные красным, незаполнены или заполнены с ошибкой</div> -->
    <label class="b-agreement"><input ng-model="validationModel.wannaNewsletter.value" type="checkbox">
        <ins class="b-checkbox"></ins>
        Я хочу получать рассылку спецпредложений</label>
</div>

<header class="buy__header">
    <h2 class="buy__title">Пассажиры</h2>
</header>

<fieldset class="buy__blocks" ng-repeat="passenger in validationModel.passengers">
    <div class="b-field-group b-field-group-passport">
        <div class="b-field-block"
             validate-events-dir ng-model="passenger.sex.value" ng-validation-model="passenger.sex"
             validate-type="validateType.sex" validate="validate(item, type)" data-title="Укажите пол пассажира">
            <label class="b-field-label">Пол</label>
            <ul class="radio-list" ng-class="{error:passenger.sex.isInvalid && !validationModel.formPure }"
                ng-init="setValid(passenger.sex, passenger.sex.value != null)">
                <li>
                    <label>
                        <input type="checkbox" name="male3" ng-model="passenger.sex.value"
                               ng-change="setValid(passenger.sex, passenger.sex.value != null)"
                               ng-checked="passenger.sex.value == sexType.man"
                               ng-true-value="{{sexType.man}}" ng-false-value="{{sexType.woman}}">
                        <ins class="radio">М</ins>
                    </label>
                </li>
                <li>
                    <label>
                        <input type="checkbox" name="male3" ng-model="passenger.sex.value"
                               ng-change="setValid(passenger.sex, passenger.sex.value != null)"
                               ng-checked="passenger.sex.value == sexType.woman"
                               ng-true-value="{{sexType.woman}}" ng-false-value="{{sexType.man}}">
                        <ins class="radio">Ж</ins>
                    </label>
                </li>
            </ul>
        </div>
        <div class="b-field-block" style="width: 160px;">
            <label class="b-field-label">Фамилия</label>
            <input autocomplete="off" upper-latin validate-events-dir ng-model="passenger.secondName.value"
                   ng-validation-model="passenger.secondName" validate="validate(item, type)"
                   data-title="Укажите фамилию пассажира"
                   validate-type="validateType.required"
                   ng-class="{error:isFieldInvalid(passenger.secondName)}"
                   type="text" placeholder="IVANOV" class="b-field-text">
        </div>
        <div class="b-field-block b-field-block-surname" style="width: 150px;">
            <label class="b-field-label">Имя</label>
            <input autocomplete="off" upper-latin validate-events-dir ng-model="passenger.name.value"
                   data-title="Укажите имя пассажира"
                   ng-validation-model="passenger.name" validate="validate(item, type)"
                   validate-type="validateType.required"
                   ng-class="{error:isFieldInvalid(passenger.name)}"
                   type="text" placeholder="IVAN" class="b-field-text">
        </div>
        <div class="b-field-block" style="width: 110px;">
            <label class="b-field-label">Дата рождения</label>
            <input autocomplete="off" validate-events-dir ng-model="passenger.birthday.value"
                   ng-validation-model="passenger.birthday" validate="validate(item, type)"
                   validate-type="validateType.birthdate"
                   ng-class="{error:isFieldInvalid(passenger.birthday)}"
                   ng-attr-data-title="{{birthTitle | breakFilter }}"
                   masked-input mask="99.99.9999" type="text" placeholder="дд.мм.гггг"
                   class="b-field-text">
        </div>
        <div class="b-field-block" style="width: 180px;">
            <label class="b-field-label">Гражданство</label>

            <div class="cit">
                <input autocomplete="off" validate-events-dir ng-model="passenger.citizenship.value.name"
                       ng-validation-model="passenger.citizenship" validate="validate(item, type)"
                       validate-type="validateType.cit_required"
                       ng-class="{error:isFieldInvalid(passenger.citizenship)}"
                       ng-click="passenger.showCitListClick($event)" type="text"
                       value="{{passenger.citizenship.value.name}}" placeholder="Выберите"
                       class="b-field-text b-field-select">

                <div partial-select list="citizenshipList" result-set="passenger.citizenship.setValue(item)"
                     is-open="passenger.dir.cit.isOpen">
                </div>
            </div>
        </div>
        <div class="b-field-block" style="width: 110px;">
            <label class="b-field-label b-field-label-docs">Серия и ном. док-та</label>
            <input autocomplete="off" validate-events-dir ng-model="passenger.doc_series_and_number.value"
                   depends-on="passenger.citizenship"
                   ng-validation-model="passenger.doc_series_and_number" validate="validate(item, type)"
                   validate-type="validateType.document"
                   ng-class="{error:isFieldInvalid(passenger.doc_series_and_number)}"
                   data-title="Неправильный номер документа"
                   type="text" class="b-field-text">
        </div>
        <div class="b-field-block" style="width: 110px;">
            <label class="b-field-label b-field-label-docs">Действителен до</label>
            <input validate-events-dir ng-model="passenger.doc_expirationDate.value"
                   depends-on="passenger.doc_series_and_number"
                   ng-validation-model="passenger.doc_expirationDate" validate="validate(item, type)"
                   validate-type="validateType.expire"
                   ng-class="{error:isFieldInvalid(passenger.doc_expirationDate)}"
                   data-title="Неправильно введена дата"
                   masked-input mask="99.99.9999" type="text" placeholder="дд.мм.гггг" class="b-field-text">
        </div>
    </div>
    <div class="b-field-group b-field-group-passport">
        <div class="b-field-group b-field-group-passport">
            <div class="b-field-block" style="width: 220px;">
                <label class="b-agreement"><input type="checkbox"
                                                  ng-model="passenger.bonuscard.value.haveBonusCard">
                    <ins class="b-checkbox"></ins>
                    Есть бонусная карта авиакомпании</label>
            </div>
            <div class="b-field-block" style="width: 150px;"
                 ng-show="passenger.bonuscard.value.haveBonusCard == true">
                <label class="b-field-label">Авиакомпания</label>

                <div class="cit">
                    <input autocomplete="off" ng-click="passenger.showCardListClick($event)" type="text"
                           value="{{passenger.bonuscard.value.airCompany.name}}"
                           class="b-field-text b-field-select" placeholder="Выберите">

                    <div partial-select list="bonusCardTransportersList"
                         result="passenger.bonuscard.value.airCompany" is-open="passenger.dir.card.isOpen">
                    </div>
                </div>
            </div>
            <div class="b-field-block" style="width: 150px;"
                 ng-show="passenger.bonuscard.value.haveBonusCard == true">
                <label class="b-field-label">Номер карты</label>
                <input autocomplete="off" digits-input type="text" maxlength="16"
                       ng-model="passenger.bonuscard.value.number" class="b-field-text"
                       placeholder="ХХХХХХХХХХХ">
            </div>
        </div>
    </div>
</fieldset>

<ng:any ng-if="addition != null">
    <header class="buy__header">
        <h2 class="buy__title">Пожелание к номеру</h2>
    </header>
    <div class="buy__comments-container">
        <textarea cols="30" rows="10" class="buy__comments-field" ng-model="addition.customerWishlist">{{addition.customerWishlist
            | breakFilter}}</textarea>

        <p class="buy__comments-help">Ваши пожелания мы передадим в отель, но не можем гарантировать их
            исполнение. Пожалуйста, пишите ваши пожелания на английском языке.</p>
    </div>
    <header class="buy__header">
        <h2 class="buy__title">Дополнительные услуги</h2>
    </header>
    <div class="buy__more-container">
        <div class="buy__more-help">Данные услуги не включены в стоимость заказа, после оплаты заказа наш
            менеджер свяжется c Вами и предложит разные варианты.
        </div>
        <ul class="buy__more-options">
            <!--<li><label class="b-agreement"><input type="checkbox" ng-model="addition.isNeededVisa">
                <ins class="b-checkbox"></ins>
                Виза</label></li>-->
            <li><label class="b-agreement"><input type="checkbox" ng-model="addition.isNeededMedicalInsurance">
                <ins class="b-checkbox"></ins>
                Страховки</label></li>
            <li><label class="b-agreement"><input type="checkbox" ng-model="addition.isNeededTransfer">
                <ins class="b-checkbox"></ins>
                Трансфер</label></li>
        </ul>
    </div>
</ng:any>
</div>
<div class="b-sum-container">
    <!--<a ng-href="#" ng-click="fillDefaultModel($event)" style="position: absolute; right: 0px;">Заполнить тестовыми данными</a>-->
    <span class="b-sum" style="">Сумма к оплате:&nbsp;</span>
        <span class="b-tickets-sum">
            <b>
                <span>{{price| price}}</span>
                <ng-include src="'components/ruble.html'"/>
            </b>
        </span>
    <a ng-if="!user.isAgency()" ng-href="#" class="button b-sum-button" ng-click="processToPayment($event)">Перейти
        к оплате</a>
    <a ng-if="user.isAgency()" ng-href="#" class="button b-sum-button"
       ng-click="processToPayment($event)">Забронировать</a>
</div>
</form>

<!-- Buy ticket -->

<ng:include src="'avia/baloon_info.html'"></ng:include>

<!-- Baloon -->
<div class="overlay js-overlay" ng-if="tarifs.isOpened">
    <div class="scroll-fix" ng-style="tarifs.style">
        <div class="balloon balloon_medium js-tarifs">
            <div title="Закрыть" class="balloon-close" ng-click="tarifs.close($event)"></div>
            <div class="b__rules-container">
                <div class="b__rules_attention">
                    <h3>Обратите внимание!</h3>

                    <p>При не использовании одного из сегментов маршрута, последующие сегменты могут быть автоматически
                        аннулированы авиакомпанией. </p>

                    <p>Если по перелёту используется несколько разных правил/тарифов, то при обмене/возврате применяются
                        более строгие правила. При обмене/возврате к возможным штрафным санкциям авиакомпании по
                        правилам
                        тарифа, дополнительно взымается сервисный сбор за услугу оформления обмена/возврата билета.</p>
                    <ul class="b__rules-flies">
                        <li ng-class="{current:item === tarifs.setected}" ng-repeat="item in tarifs.list"><a ng-href="#"
                                                                                                             ng-click="tarifs.tarifClick($event, item)"><span><b>{{item.from}}
                            → {{item.to}},</b> {{item.num}}, {{tarifs.class}} (K)</span></a></li>
                    </ul>
                </div>
                <div class="b__rules-grey">
                    <h3>{{tarifs.setected.from}} → {{tarifs.setected.to}}</h3>
                    <h4>Полные правила применения тарифа</h4>
                    <!--<p>Пожалуйста, ознакомьтесь детальнее с условиями <a href="#">обмена/возврата</a>.</p>-->
                    <p ng-bind-html="tarifs.tarifItem.Text | breakFilter"></p>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- /Baloon -->

<!-- Baloon cancel hotel -->
<div class="overlay js-overlay" ng-if="hotelRules.isOpened">
    <div class="scroll-fix" ng-style="hotelRules.style">
        <div class="balloon balloon_ticket">
            <div title="Закрыть" class="balloon-close" ng-click="hotelRules.close($event)"></div>
            <h3 class="balloon__title">Условия и правила по отелю</h3>

            <div class="balloon__text-block">
                <h4 class="balloon__title-sec">Условия заселения</h4>
                <ul class="balloon__list">
                    <li>Заезд: до {{hotelRules.checkIn}}</li>
                    <li>Выезд: до {{hotelRules.checkOut}}</li>
                </ul>
            </div>
            <div class="balloon__text-block"
                 ng-if="hotelRules.cancellationRules != null && hotelRules.cancellationRules.length > 0">
                <h4 class="balloon__title-sec">Правила отмены</h4>
                <!--<ul class="balloon__list">
                    <li>В случае отмены или изменения бронирования в срок до 1 суток до даты заезда
        штраф не взимается.</li>
                    <li>В случае отмены или изменения бронирования позднее этого срока или в случае
        незаезда взимается 100 процентов от стоимости первой ночи проживания.</li>
                </ul>-->
                <p ng-bind-html="hotelRules.cancellationRules | breakFilter"></p>
            </div>
            <div class="balloon__text-block" ng-if="hotelRules.extra.List.length > 0">
                <h4 class="balloon__title-sec">Дополнительно</h4>
                <ul class="balloon__list">
                    <li ng-repeat="item in hotelRules.extra.List">{{item}}</li>
                </ul>
            </div>
        </div>
    </div>
</div>
<!-- /Baloon -->