<ng-include src="'components/wl-new-search/templ/index.hbs.html'"></ng-include>

<div class="hotel-details ng-cloak" ng-class="{'hotel-details_display-order' : isDisplayOrder}" ng-if="hotelLoaded">

	<div class="hotel-details__wrap main__center">

		<div class="hotel-details__section hotel-details__section__crumbs">
			<ul class="section__crumbs__list">
				<li class="section__crumbs__list__item">
					<a href="/#/" class="section__crumbs__list__item__link">Главная</a>
				</li>
				<li class="section__crumbs__list__item">
					<a href="{{goToSearchDynamic()}}" class="section__crumbs__list__item__link">Результаты поиска</a>
				</li>
				<li class="section__crumbs__list__item">
					Описание отеля и выбор номера
				</li>
			</ul>
		</div>

		<div class="hotel-details__section hotel-details__section_layout_context">

			<div class="hotel-details__ta hotel-details-ta-info"
			     ng-click="goToScroll('SectionReviews')" ng-if="hotel.TaFactor">

				<!-- tripadvisor -->
				<div trip-advisor-directive
				     hotel-data="hotel"
				     templ="ta.detail.html"></div>

			</div>

			<div class="hotel-details-name">
				<!-- Stars -->
                <span stars-directive
                      hotel-data="hotel.Stars"
                      class="hotel-details-stars"></span>

                <span class="hotel-details-name__title">
	                {{hotel.HotelName}}
                </span>
			</div>

		</div>

		<!-- Меню с якорями -->
		<div class="hotel-details__section_menu">
			<div class="btn-group btn-group-justified">

				<div ng-repeat="menu in Menu"
				     ng-click="goToScroll(menu, $event)"
				     class="btn hotel-details__section_menu__item">
					<!--ng-class="{'btn-active btn-green' : menu.active }"-->

					<i class="{{menu.klass}} hotel-details__section_menu__icon"></i>
					<!--ng-if="!menu.active"-->
					<!--<i class="{{menu.klass}}-active hotel-details__section_menu__icon" ng-if="menu.active"></i>-->
					<span>{{menu.name}}</span>
				</div>
			</div>
		</div>

		<div class="hotel-details__section hotel-details__section_gallery">
			<div inna-gallery
			     ng-if="(hotel.Photos && (hotel.Photos.LargePhotos.length || hotel.Photos.MediumPhotos.length))"
			     photos="hotel.Photos"></div>
		</div>

		<div class="hotel-details__section" id="SectionDetail" ng-if="hotel.Description">
			<div class="hotel-details__section-box">
				<h2 class="hotel-details__section-title">Описание отеля</h2>

				<div class="hotel-details__section-text">
					<div class="hotel-details__section-text-viewport"
					     ng-class="{'hotel-details__section-text-viewport_state_open': showFullDescription}">

						<div ng-repeat="section in hotel.Description track by $index">
							<div ng-if="!showFullDescription" ng-bind-html="section.Content | limitFilter:300"></div>
							<div ng-if="showFullDescription" ng-bind-html="section.Content"></div>
						</div>
						<p ng-if="showFullDescription">
							<b>Подробные сведения</b><br/><br/>
							<b>Время прибытия:</b>&nbsp;{{hotel.CheckInTime}}
							&nbsp;&nbsp;&nbsp;&nbsp;
							<b>Выезд:</b>&nbsp;{{hotel.CheckOutTime}}
						</p>
					</div>

					<p>
						<span class="hotel-details__section-text-more"
						      ng-if="showFullDescription"
						      ng-click="toggleDescription()">Свернуть</span>

						<span class="hotel-details__section-text-more"
						      ng-if="!showFullDescription"
						      ng-click="toggleDescription()">Развернуть</span>
					</p>
				</div>
				<ul class="hotel-details-extra" ng-if="hotel.Extra">
					<li ng-repeat="(key, val) in hotel.Extra track by $index"
					    class="hotel-details-extra__item">
						<!--hotel-details-extra__item_description hotel-details-extra__item_type_{{key | lowercase}}-->
						<!--<i class="icon-type-extra icon-type-extra-{{key | lowercase}}"></i>-->
						{{val}}
					</li>
				</ul>
			</div>
		</div>

		<div class="hotel-details__section" ng-if="!hotelOnly && !displayRoom">

			<div class="hotel-details__section__header">
				<span class="hotel-details__price">
					Стоимость пакета, включая налоги и сборы:
					<b>
						{{recommendedPair.getFullPackagePrice() | price}}
						<ng-include src="'components/ruble.html'"></ng-include>
					</b>
				</span>

				<h2 class="hotel-details__section-title">
					<span>Пакет с этим отелем</span>
					<!--<span ng-if="!buyAction">Пакет с этим отелем</span>
					<span ng-if="buyAction">Выбранный пакет</span>-->
				</h2>
			</div>

			<!-- Динамический блок -->
			<div dynamic-block-directive
			     recommended-pair="recommendedPair"
				 more-info="true"
			     settings='{
					     "height": 220,
					     "countColumn": 2,
					     "classBlock": "buy__fly b-result_col_two b-result_middle"
				 }'
			     tripadvisor="false"></div>
		</div>

		<div class="hotel-details__section" id="SectionRoom">
			<h2 class="hotel-details__section-title" ng-if="!hotelOnly">Выбор номера</h2>

			<h2 class="hotel-details__section-title" ng-if="hotelOnly">Номер</h2>

			<div class="spinner" ng-if="!dataFullyLoaded">
				<div class="rect rect1"></div>
				<div class="rect rect2"></div>
				<div class="rect rect3"></div>
				<div class="rect rect4"></div>
				<div class="rect rect5"></div>
				<img class="gif" src="/spa/img/spinner.gif">

				<div class="spinner__text">Секундочку, загружаем список номеров</div>
			</div>

			<div class="hotel-details-rooms hotel-details-room_show_{{displayRoom || 'NONE'}}">
				<ng:include src="'pages/page-dynamic-details/templ/hotel-details-room.html'"
				            ng-repeat="room in (onlyRoom || hotelRooms) track by $index"></ng:include>
			</div>
		</div>

		<div class="hotel-details__section" id="SectionServices">
			<h2 class="hotel-details__section-title">Сервисы</h2>

			<div class="hotel-details-resume">
				<div class="hotel-details-resume__section hotel-details-resume__section_{{key}}"
				     ng-repeat="Amenities in hotel.AmenitiesArray track by $index">
					<h4 class="hotel-details-resume__section-title">{{Amenities.CategoryName}}</h4>


					<!-- сделано в тупую : руками разбил массив на две части в методе parseAmenities -->
					<div class="hotel-details-resume__wrapper">
						<ul class="hotel-details-resume__list" ng-if="Amenities.part.part1.length">
							<li class="hotel-details-resume__item"
							    ng-repeat="item in Amenities.part.part1 track by $index">
								{{item}}
							</li>
						</ul>

						<ul class="hotel-details-resume__list" ng-if="Amenities.part.part2.length">
							<li class="hotel-details-resume__item"
							    ng-repeat="item in Amenities.part.part2 track by $index">
								{{item}}
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>

		<div class="hotel-details__section hotel-details__section_map" id="SectionMap">
			<h2 class="hotel-details__section-title">{{hotel.HotelCityName}}, {{hotel.Address}}</h2>

			<div class="hotel-details-map" ng-class="{'hotel-details-map_display_fullscreen': showMapFullScreen}">
				<div id="hotel-details-map"></div>
			</div>
		</div>

		<div class="b-tripadvisor-widget-iframe" id="SectionReviews" ng-if="hotel.TaFactor">
			<iframe
					class="iframe_widget"
					name="tripadvisor"
					ng-src="{{TAWidget}}"
					height="500"
					width="100%"
					frameborder="0"></iframe>
		</div>
	</div>
</div>

<div class="gallery__list-item_hover"
     ng-style="hoverImageObject.hoverImageStyle"
     ng-if="hoverImageObject.hoverImageShow">
</div>
<!-- Попап - подробнее о авиа-билете -->
<!--ng-if="isDisplayOrder && displayTicket"-->
<div ticket-details></div>