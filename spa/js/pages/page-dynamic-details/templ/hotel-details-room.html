<div class="hotel-details-rooms__room"
     ng-class="{'hotel-details-rooms__room_state_open': room.isOpen, 'hotel-details-rooms__room_position_last': $last}">

	<div class="hotel-details-rooms__room__item" ng-click="toggleRoom(room)">
		<div class="row hotel-details-rooms__room__item-info">

			<div class="hotel-details-rooms__room-desc"
			     ng-class="{'hotel-details-rooms__room-desc_empty' : !RoomsPhotosIsEmpty}">


				<div gallery-preview
				    ng-click="showFullGallery($event)"
				    photo="room.Photos.BaseUrl"
				    width="80"
				    height="80"
				    width-preview="320"
				    height-preview="270"
				    hover-image-object="hoverImageObject"
				    class="hotel-details-rooms__room_pic"
					ng-if="room.Photos"></div>

				<div class="hotel-details-rooms__room_pic"
				     ng-if="!room.Photos"></div>

				<h3 class="hotel-details-rooms__room-title">
					<span class="like-link">{{room.RoomName}}</span>


                    <span tooltip-directive-base
                          ng-if="userIsAgency && (AgencyId == 20005)"
                          templ="empty.hbs.html"
                          el="true"
                          tooltip-klass="agency-inna"
                          position="right"
                          content-html="Комнат <b>{{room.RoomCount}}</b>. Цена <b>{{room.PackagePriceService}}</b> р"
                          class="b-display-inline"></span>
				</h3>

				<div class="hotel-details-rooms__room_bed-type-list">
                    <span ng-repeat="bed in room.BedTypeList">
                        {{bed.Name}}<span ng-if="!$last">,&nbsp;</span>
                    </span>
				</div>


	            <span class="hotel-details-rooms__room-rules-warning"
	                  ng-if="userIsAgency && (!room.IsRefundable || (room.IsRefundable && room.IsReturnsWithFine))">
	                <i class="icon-sprite-b2b-error-hotel css-sprite-b2b-error-hotel"></i>
	                бронирование возможно после оплаты
                </span>

				<ul class="hotel-details-extra">
					<li ng-repeat="(name, caption) in room.Extra"
					    class="hotel-details-extra__item hotel-details-extra__item_type_{{name | lowercase}}">
						<i class="icon-type-extra icon-type-extra-{{name | lowercase}}"></i>{{caption.CategoryName}}
					</li>
				</ul>
			</div>

			<div class="col-xs-2 hotel-details-rooms__room-cancel-rules">
                <span class="hotel-details-rooms__room-cancel-rules-ok"
                      ng-if="room.IsRefundable && room.IsReturnsWithFine">
                    Отмена бронирования со штрафом
                </span>
				<span ng-if="!room.IsRefundable">Без возможности возврата</span>

				<div class="hotel-details-rooms__room-warning" ng-if="room.RoomCount == 1">Остался последний
					номер!
				</div>
				<div class="hotel-details-rooms__room-warning" ng-if="room.RoomCount == 2">Осталось два номера!
				</div>
				<div class="hotel-details-rooms__room-warning" ng-if="room.RoomCount == 3">Осталось три номера!
				</div>
			</div>

			<div class="col-xs-3 hotel-details-rooms__room-price">
				<div class="hotel-details-rooms__room-price-diff" ng-if="!hotelOnly">

					<div ng-if="room.Default && NewPrice"
					     tooltip-directive-base
					     tooltip-klass="nocorner:tooltip-price"
					     position="top"
					     pin="center"
					     is-visible="true"
					     position-style="absolute"
					     width="300" ,
					     close="true"
					     property-watch="NewPricePackage"
					     templ="popover.change-price.hbs.html">
					</div>

                    <span ng-if="room.Default">
	                    Включен в цену
                    </span>
                    <span ng-if="!room.Default">
	                    {{room.PackagePrice - recommendedPair.getFullPackagePrice() | signed}}
	                    <ng-include src="'components/ruble.html'"></ng-include>
                    </span>
					<span class="icon-crown icon-sprite-crown" ng-if="room.IsPackage"></span>
				</div>

				<div class="hotel-details-rooms__room-price-full" ng-if="!hotelOnly">
					К оплате: {{room.PackagePrice | price}}
					<ng-include src="'components/ruble.html'"></ng-include>
				</div>
			</div>

			<div class="hotel-details-rooms__room-actions">
                <span class="btn btn-large btn-green btn-hotel-room-actions"
                      ng-click="goReservation(room)"
                      ng-if="!hotelOnly">Купить</span>
			</div>
		</div>
	</div>
	<div class="hotel-details-rooms__room__details">

		<div class="balloon-close" ng-click="toggleRoom(room)" title="Закрыть">
			<i class="icon-sprite-remove-blue"></i>
		</div>

		<!--<ul class="mini-gallery" ng-if="room.Photos && (room.Photos.LargePhotos && room.Photos.LargePhotos.length)">
			<li ng-repeat="pic in room.Photos.LargePhotos"
				class="mini-gallery__mini"
				style="background-image:url({{room.Photos.BaseUrl + pic}});">
				<div class="mini-gallery__big">
					<img class="mini-gallery__big-img" ng-src="{{room.Photos.BaseUrl + pic}}" alt=""/>
				</div>
				</li>
		</ul>-->

		<div class="hotel-details-rooms__room__details__text">
			<p ng-bind-html="room.Description | stripTags"></p>

			<h3 ng-if="room.Extra">Включено в стоимость</h3>

			<p ng-if="room.Extra">
                <span ng-repeat="(name, list) in room.Extra" ng-init="isLastExtra = $last">
                    <span ng-repeat-start="item in list.List" ng-init="isLastItem = $last">{{item}}</span>
                    <span ng-if="!isLastExtra || !isLastItem">, </span>
                    <span ng-if="isLastExtra && isLastItem" ng-repeat-end>.</span>
                </span>
			</p>

			<h3 ng-if="room.RoomAmenities">Услуги</h3>

			<p ng-if="room.RoomAmenities">
                <span ng-repeat="am in room.RoomAmenities">
                    {{am.Name}}
                    <span ng-if="!$last">,&nbsp;</span>
                    <span ng-if="$last">.</span>
                </span>
			</p>

			<div ng-if="room.CancellationRule">
				<h3>Правила отмены</h3>

				<p ng-bind-html="room.CancellationRule"></p>

				<div ng-bind-html="room.PolicyDescription"></div>
			</div>
		</div>
	</div>
</div>

